(function(e,t,n,r){function o(t,n){this.elem=t;this.options=e.extend({},s,n);this._defaults=s;this._name=i;this.init();this.execute()}var i="Dotter",s={};o.prototype.init=function(){this._originString=this.elem.text().toString()};o.prototype.execute=function(){function a(e,t){e.html(t);var n=e.width();e.html("");return n}var e=this.elem.css("font-size");var t=this.produceVirtualElement();var n=this._originString.split("");var r=this.options.tail||"...";var i=a(t,r);var s=[];var o=0;if(this.options.multiLine){while(t.height()<this.elem.height()&&o<n.length){t.html(t.text().replace(r,""));t.append(n[o]+r);s.push(n[o]);o++}if(t.height()>this.elem.height()){s=s.splice(0,s.length-1)}}else{while(t.width()+i<this.elem.width()&&o<n.length){t.append(n[o]);s.push(n[o]);o++}if(t.width()+i>this.elem.width()){s=s.splice(0,s.length-1)}}var u;if(o===n.length)u=s.join("");else u=s.join("")+r;this.elem.html(u);t.remove();return this.elem};o.prototype.produceVirtualElement=function(){var t=e("<"+this.elem[0].nodeName.toString()+">").appendTo("body");t.attr("style",this.elem.attr("style")).attr("class",this.elem.attr("class"));if(this.options.multiLine){t.css({height:"auto",display:"inline-block"})}else{t.css({width:"auto",display:"inline-block"})}return t};e.fn[i]=function(t){var n=this;return this.each(function(){if(!e.data(this,"plugin_"+i)){e.data(this,"plugin_"+i,new o(n,t))}else{e.data(this,"plugin_"+i).execute()}})}})(jQuery,window,document)